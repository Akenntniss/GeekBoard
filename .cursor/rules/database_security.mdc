# S√©curit√© des Connexions de Base de Donn√©es Multi-Magasin

## INTERDICTIONS ABSOLUES

### ‚ùå JAMAIS de Connexions PDO Directes
- **INTERDIT** : `new PDO('mysql:host=localhost;dbname=geekboard_*', ...)`
- **INTERDIT** : Connexions directes √† des bases de donn√©es sp√©cifiques
- **INTERDIT** : Noms de bases de donn√©es hardcod√©s dans le code

```php
// ‚ùå STRICTEMENT INTERDIT
$pdo = new PDO('mysql:host=localhost;dbname=geekboard_mkmkmk', 'root', 'password');
```

### ‚ùå JAMAIS d'Identifiants Hardcod√©s
- **INTERDIT** : Mots de passe en dur dans le code
- **INTERDIT** : Noms d'utilisateurs en dur
- **INTERDIT** : Noms de serveurs en dur

## UTILISATION OBLIGATOIRE

### ‚úÖ Fonctions Syst√®me Autoris√©es UNIQUEMENT
- **OBLIGATOIRE** : `getShopDBConnection()` pour les donn√©es magasin
- **OBLIGATOIRE** : `getMainDBConnection()` pour les donn√©es g√©n√©rales
- **OBLIGATOIRE** : `getShopDBConnectionById($shop_id)` pour un magasin sp√©cifique

```php
// ‚úÖ CORRECT : Respecte le syst√®me multi-magasin
$shop_pdo = getShopDBConnection();
if (!$shop_pdo) {
    if (!isset($_SESSION['shop_id'])) {
        header('Location: ../index.php');
        exit;
    }
    die("Erreur de connexion √† la base de donn√©es du magasin");
}
```

### ‚úÖ Gestion des Erreurs Obligatoire
- **OBLIGATOIRE** : V√©rifier `if (!$shop_pdo)` apr√®s chaque appel
- **OBLIGATOIRE** : V√©rifier `$_SESSION['shop_id']` si connexion √©choue
- **OBLIGATOIRE** : Rediriger vers la page de connexion si pas de shop_id

## POURQUOI CES R√àGLES SONT CRITIQUES

### üîí S√©curit√© Multi-Magasin
- Chaque magasin a sa propre base de donn√©es
- Les utilisateurs ne doivent voir que LEURS donn√©es
- Une connexion directe peut exposer des donn√©es d'autres magasins

### üõ°Ô∏è Isolation des Donn√©es
- `shop_id` en session d√©termine la base de donn√©es appropri√©e
- Les fonctions syst√®me g√®rent automatiquement la s√©lection
- Pr√©vient les fuites de donn√©es entre magasins

**‚ö†Ô∏è ATTENTION CRITIQUE ‚ö†Ô∏è**

Toute violation de ces r√®gles peut compromettre la s√©curit√© et l'int√©grit√© du syst√®me multi-magasin. Les connexions PDO directes sont strictement interdites et doivent √™tre imm√©diatement corrig√©es si d√©couvertes.
description:
globs:
alwaysApply: false
---
