<!DOCTYPE html>
<html>
<head>
    <title>Debug Recherche</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h2>Test de Recherche - Debug</h2>
        <button class="btn btn-primary" onclick="testAPI()">Test API Direct</button>
        <button class="btn btn-success" onclick="testInjection()">Test Injection HTML</button>
        
        <div class="mt-4">
            <div id="results"></div>
        </div>
    </div>

    <script>
        function testAPI() {
            console.log('üîß Test API Direct...');
            
            fetch('ajax/recherche-simple.php', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: 'terme=iu'
            })
            .then(response => response.json())
            .then(data => {
                console.log('üìã R√©ponse API:', data);
                document.getElementById('results').innerHTML = '<div class="alert alert-success">API OK: ' + JSON.stringify(data) + '</div>';
                
                // Test des conditions exactes
                console.log('üîç Tests de conditions:');
                console.log('  data.success:', data.success, typeof data.success);
                console.log('  data.resultats:', data.resultats);
                console.log('  Array.isArray(data.resultats):', Array.isArray(data.resultats));
                console.log('  data.resultats.length:', data.resultats ? data.resultats.length : 'N/A');
                console.log('  Condition finale:', !!(data.success && data.resultats && data.resultats.length > 0));
            })
            .catch(error => {
                console.error('‚ùå Erreur API:', error);
                document.getElementById('results').innerHTML = '<div class="alert alert-danger">Erreur: ' + error + '</div>';
            });
        }
        
        function testInjection() {
            console.log('üîß Test Injection HTML...');
            
            const html = `
                <div class="alert alert-info">
                    <h5>Test d'injection HTML r√©ussi!</h5>
                    <table class="table table-striped">
                        <thead>
                            <tr><th>Nom</th><th>T√©l√©phone</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Test Client</td><td>0123456789</td></tr>
                        </tbody>
                    </table>
                </div>
            `;
            
            document.getElementById('results').innerHTML = html;
            console.log('‚úÖ HTML inject√© avec succ√®s');
        }
    </script>
</body>
</html> 